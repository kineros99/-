<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover" />
    <title>AquiFacil - Lojas de Material de Constru√ß√£o</title>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <link rel="stylesheet" href="https://unpkg.com/leaflet.markercluster/dist/MarkerCluster.css" />
    <link rel="stylesheet" href="https://unpkg.com/leaflet.markercluster/dist/MarkerCluster.Default.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="styles.css" />
    <!-- <link rel="stylesheet" href="logger.css" /> DISABLED: Logger causing performance issues -->
</head>
<body>
    <header>
        <button id="toggle-sidebar-btn"><i class="fas fa-bars"></i></button>
        <div class="header-brand">
            <img src="/images/aquifacil-logo.jpeg" alt="AquiFacil Logo" class="header-logo">
            <span class="header-title">AquiFacil</span>
        </div>
        <a href="admin.html" id="admin-btn" title="Admin Panel">
            <i class="fas fa-cog"></i>
        </a>
    </header>

    <div id="overlay"></div>

    <div class="wrapper">
        <div id="sidebar">
            <div class="filter-section">
                <h2><i class="fas fa-sliders-h"></i> Filtros</h2>
                <div style="margin-top: 15px;">
                    <input type="text" id="searchInput" placeholder="üîç Buscar por nome ou endere√ßo...">
                </div>

                <label for="city-search"><i class="fas fa-city"></i> Cidade</label>
                <div class="city-search-container">
                    <input
                        type="text"
                        id="city-search"
                        placeholder="Digite o nome da cidade..."
                        autocomplete="off"
                    />
                    <div id="city-dropdown" class="city-dropdown"></div>
                </div>
                <div id="selected-city-info" class="selected-city-info" style="display: none;">
                    <i class="fas fa-check-circle"></i> <span id="selected-city-name"></span>
                    <button id="clear-city-btn" class="clear-city-btn" title="Limpar sele√ß√£o de cidade">
                        <i class="fas fa-times"></i>
                    </button>
                </div>

                <label for="bairro-filter"><i class="fas fa-map-marker-alt"></i> Bairro</label>
                <select id="bairro-filter">
                    <option value="">Todos os bairros</option>
                    <!-- Bairros carregados dinamicamente do banco de dados -->
                </select>

                <label for="category-filter"><i class="fas fa-tags"></i> Tipo de Loja</label>
                <select id="category-filter">
                    <option value="all">Todos os Tipos</option>
                    <option value="paint">üé® Tintas</option>
                    <option value="lumber">ü™µ Madeira</option>
                    <option value="plumbing">üîß Hidr√°ulica</option>
                    <option value="hardware">üî® Ferragens</option>
                    <option value="general">üèóÔ∏è Material de Constru√ß√£o</option>
                    <option value="unknown">‚ùì N√£o Categorizado</option>
                </select>

                <label for="source-filter"><i class="fas fa-filter"></i> Fonte dos Dados</label>
                <select id="source-filter">
                    <option value="all">Todas as Lojas</option>
                    <option value="user">üôÇ Apenas Usu√°rios</option>
                    <option value="auto">üôÉ Apenas Auto-populadas</option>
                    <option value="verified">üßµ Apenas Verificadas</option>
                </select>

                <label for="radius-filter"><i class="fas fa-circle-notch"></i> Raio de Busca</label>
                <div style="display: flex; align-items: center; gap: 10px; margin-bottom: 10px;">
                    <input type="range" id="radius-slider" min="1" max="50" value="50" style="flex: 1;">
                    <span id="radius-value" style="min-width: 50px; font-weight: bold; color: var(--primary-blue);">50 km</span>
                </div>
                <small style="color: #666; display: block; margin-top: -5px; margin-bottom: 10px;">
                    Use o bot√£o üìç para ativar busca por raio
                </small>

                <div class="btn-group">
                    <button class="btn" id="filter-btn">
                        <i class="fas fa-search"></i> Buscar
                    </button>
                    <button class="btn" id="geolocate-btn" title="Minha Localiza√ß√£o">
                        <i class="fas fa-location-arrow"></i>
                    </button>
                </div>

                <button class="btn" id="reset-btn"><i class="fas fa-redo"></i> Limpar Filtro</button>
                <button class="btn special" id="open-register-modal-btn"><i class="fas fa-plus-circle"></i> Cadastre sua Loja</button>
            </div>

            <div class="results-header">
                <h3><i class="fas fa-store"></i> Lojas</h3>
                <span id="resultsCount" class="results-count">0</span>
            </div>
            <div id="lojasList"></div>
        </div>
        <div id="map"></div>
    </div>

    <div id="register-modal" class="modal">
        <div class="modal-content">
            <span class="close-button">&times;</span>
            <h2>Cadastre ou Gerencie sua Loja</h2>
            <p>Insira um nome de usu√°rio √∫nico. Se n√£o existir, ser√° criado junto com a sua loja.</p>
            <form id="register-form">
                <div class="form-section">
                    <h4>Identifica√ß√£o</h4>
                    <label for="username">Nome de Usu√°rio (√∫nico)</label>
                    <input type="text" id="username" name="username" required placeholder="Ex: amoedobotafogo">
                </div>
                <div class="form-section">
                    <h4>Dados da Loja</h4>
                    <label for="nome">Nome da Loja</label>
                    <input type="text" id="nome" name="nome" required>
                    <label for="endereco">Endere√ßo Completo</label>
                    <input type="text" id="endereco" name="endereco" required placeholder="Rua, N√∫mero, Bairro, Cidade, Estado">
                    <label for="categoria">Categoria</label>
                    <input type="text" id="categoria" name="categoria" placeholder="Material de Constru√ß√£o">
                    <label for="telefone">Telefone</label>
                    <input type="tel" id="telefone" name="telefone">
                    <label for="website">Website (opcional)</label>
                    <input type="url" id="website" name="website" placeholder="https://sualoja.com">
                </div>
                <button type="submit" id="submit-button">Cadastrar Loja</button>
                <div id="form-message"></div>
            </form>
        </div>
    </div>

    <footer id="partner-footer">
        <div class="partner-container">
            <div class="partner-logo-slot"></div>
            <div class="partner-logo-slot"></div>
            <div class="partner-logo-slot"></div>
            <div class="partner-logo-slot"></div>
            <div class="partner-logo-slot"></div>
        </div>
    </footer>

    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <script src="https://unpkg.com/leaflet.markercluster/dist/leaflet.markercluster.js"></script>
    <!-- <script src="logger.js"></script> DISABLED: Logger causing performance issues and infinite reloads -->
    <script src="script.js"></script>
</body>
</html>